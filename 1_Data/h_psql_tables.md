
## LOAD CSV INTO TABLE:

COPY h_full FROM '/Users/moserfamily/Documents/DSI/DSI_Capstone_B/1_Data/form5500_data/F_SCH_H_2017_latest.csv' DELIMITER ',' CSV HEADER QUOTE '"';
COPY h_full FROM '/Users/moserfamily/Documents/DSI/DSI_Capstone_B/1_Data/form5500_data/F_SCH_H_2016_latest.csv' DELIMITER ',' CSV HEADER QUOTE '"';
COPY h_full FROM '/Users/moserfamily/Documents/DSI/DSI_Capstone_B/1_Data/form5500_data/F_SCH_H_2015_latest.csv' DELIMITER ',' CSV HEADER QUOTE '"';

## Drop columns that are only in 2017 and 2016 file (not in 2015)
ALTER TABLE h_full
DROP COLUMN DISTRIB_MADE_EMPLOYEE_62_IND,
DROP COLUMN PREMIUM_FILING_CONFIRM_NUMBER;

## CREATE TABLE - ALL FIELDS:

CREATE TABLE h_full (
  ACK_ID character varying(30),
  SCH_H_PLAN_YEAR_BEGIN_DATE date,
  SCH_H_TAX_PRD character varying,
  SCH_H_PN bigint,
  SCH_H_EIN bigint,
  NON_INT_BEAR_CASH_BOY_AMT bigint,
  EMPLR_CONTRIB_BOY_AMT bigint,
  PARTCP_CONTRIB_BOY_AMT bigint,
  OTHER_RECEIVABLES_BOY_AMT bigint,
  INT_BEAR_CASH_BOY_AMT bigint,
  GOVT_SEC_BOY_AMT bigint,
  CORP_DEBT_PREFERRED_BOY_AMT bigint,
  CORP_DEBT_OTHER_BOY_AMT bigint,
  PREF_STOCK_BOY_AMT bigint,
  COMMON_STOCK_BOY_AMT bigint,
  JOINT_VENTURE_BOY_AMT bigint,
  REAL_ESTATE_BOY_AMT bigint,
  OTHER_LOANS_BOY_AMT bigint,
  PARTCP_LOANS_BOY_AMT bigint,
  INT_COMMON_TR_BOY_AMT bigint,
  INT_POOL_SEP_ACCT_BOY_AMT bigint,
  INT_MASTER_TR_BOY_AMT bigint,
  INT_103_12_INVST_BOY_AMT bigint,
  INT_REG_INVST_CO_BOY_AMT bigint,
  INS_CO_GEN_ACCT_BOY_AMT bigint,
  OTH_INVST_BOY_AMT bigint,
  EMPLR_SEC_BOY_AMT bigint,
  EMPLR_PROP_BOY_AMT bigint,
  BLDGS_USED_BOY_AMT bigint,
  TOT_ASSETS_BOY_AMT bigint,
  BNFTS_PAYABLE_BOY_AMT bigint,
  OPRTNG_PAYABLE_BOY_AMT bigint,
  ACQUIS_INDBT_BOY_AMT bigint,
  OTHER_LIAB_BOY_AMT bigint,
  TOT_LIABILITIES_BOY_AMT bigint,
  NET_ASSETS_BOY_AMT bigint,
  NON_INT_BEAR_CASH_EOY_AMT bigint,
  EMPLR_CONTRIB_EOY_AMT bigint,
  PARTCP_CONTRIB_EOY_AMT bigint,
  OTHER_RECEIVABLES_EOY_AMT bigint,
  INT_BEAR_CASH_EOY_AMT bigint,
  GOVT_SEC_EOY_AMT bigint,
  CORP_DEBT_PREFERRED_EOY_AMT bigint,
  CORP_DEBT_OTHER_EOY_AMT bigint,
  PREF_STOCK_EOY_AMT bigint,
  COMMON_STOCK_EOY_AMT bigint,
  JOINT_VENTURE_EOY_AMT bigint,
  REAL_ESTATE_EOY_AMT bigint,
  OTHER_LOANS_EOY_AMT bigint,
  PARTCP_LOANS_EOY_AMT bigint,
  INT_COMMON_TR_EOY_AMT bigint,
  INT_POOL_SEP_ACCT_EOY_AMT bigint,
  INT_MASTER_TR_EOY_AMT bigint,
  INT_103_12_INVST_EOY_AMT bigint,
  INT_REG_INVST_CO_EOY_AMT bigint,
  INS_CO_GEN_ACCT_EOY_AMT bigint,
  OTH_INVST_EOY_AMT bigint,
  EMPLR_SEC_EOY_AMT bigint,
  EMPLR_PROP_EOY_AMT bigint,
  BLDGS_USED_EOY_AMT bigint,
  TOT_ASSETS_EOY_AMT bigint,
  BNFTS_PAYABLE_EOY_AMT bigint,
  OPRTNG_PAYABLE_EOY_AMT bigint,
  ACQUIS_INDBT_EOY_AMT bigint,
  OTHER_LIAB_EOY_AMT bigint,
  TOT_LIABILITIES_EOY_AMT bigint,
  NET_ASSETS_EOY_AMT bigint,
  EMPLR_CONTRIB_INCOME_AMT bigint,
  PARTICIPANT_CONTRIB_AMT bigint,
  OTH_CONTRIB_RCVD_AMT bigint,
  NON_CASH_CONTRIB_BS_AMT bigint,
  TOT_CONTRIB_AMT bigint,
  INT_BEAR_CASH_AMT bigint,
  INT_ON_GOVT_SEC_AMT bigint,
  INT_ON_CORP_DEBT_AMT bigint,
  INT_ON_OTH_LOANS_AMT bigint,
  INT_ON_PARTCP_LOANS_AMT bigint,
  INT_ON_OTH_INVST_AMT bigint,
  TOTAL_INTEREST_AMT bigint,
  DIVND_PREF_STOCK_AMT bigint,
  DIVND_COMMON_STOCK_AMT bigint,
  REGISTERED_INVST_AMT bigint,
  TOTAL_DIVIDENDS_AMT bigint,
  TOTAL_RENTS_AMT bigint,
  AGGREGATE_PROCEEDS_AMT bigint,
  AGGREGATE_COSTS_AMT bigint,
  TOT_GAIN_LOSS_SALE_AST_AMT bigint,
  UNREALZD_APPRCTN_RE_AMT bigint,
  UNREALZD_APPRCTN_OTH_AMT bigint,
  TOT_UNREALZD_APPRCTN_AMT bigint,
  GAIN_LOSS_COM_TRUST_AMT bigint,
  GAIN_LOSS_POOL_SEP_AMT bigint,
  GAIN_LOSS_MASTER_TR_AMT bigint,
  GAIN_LOSS_103_12_INVST_AMT bigint,
  GAIN_LOSS_REG_INVST_AMT bigint,
  OTHER_INCOME_AMT bigint,
  TOT_INCOME_AMT bigint,
  DISTRIB_DRT_PARTCP_AMT bigint,
  INS_CARRIER_BNFTS_AMT bigint,
  OTH_BNFT_PAYMENT_AMT bigint,
  TOT_DISTRIB_BNFT_AMT bigint,
  TOT_CORRECTIVE_DISTRIB_AMT bigint,
  TOT_DEEMED_DISTR_PART_LNS_AMT bigint,
  TOT_INT_EXPENSE_AMT bigint,
  PROFESSIONAL_FEES_AMT bigint,
  CONTRACT_ADMIN_FEES_AMT bigint,
  INVST_MGMT_FEES_AMT bigint,
  OTHER_ADMIN_FEES_AMT bigint,
  TOT_ADMIN_EXPENSES_AMT bigint,
  TOT_EXPENSES_AMT bigint,
  NET_INCOME_AMT bigint,
  TOT_TRANSFERS_TO_AMT bigint,
  TOT_TRANSFERS_FROM_AMT bigint,
  ACCTNT_OPINION_TYPE_CD character varying(1),
  ACCT_PERFORMED_LTD_AUDIT_IND character varying(1),
  ACCOUNTANT_FIRM_NAME character varying,
  ACCOUNTANT_FIRM_EIN bigint,
  ACCT_OPIN_NOT_ON_FILE_IND character varying(1),
  FAIL_TRANSMIT_CONTRIB_IND character varying(1),
  FAIL_TRANSMIT_CONTRIB_AMT bigint,
  LOANS_IN_DEFAULT_IND character varying(1),
  LOANS_IN_DEFAULT_AMT bigint,
  LEASES_IN_DEFAULT_IND character varying(1),
  LEASES_IN_DEFAULT_AMT bigint,
  PARTY_IN_INT_NOT_RPTD_IND character varying(1),
  PARTY_IN_INT_NOT_RPTD_AMT bigint,
  PLAN_INS_FDLTY_BOND_IND character varying(1),
  PLAN_INS_FDLTY_BOND_AMT bigint,
  LOSS_DISCV_DUR_YEAR_IND character varying(1),
  LOSS_DISCV_DUR_YEAR_AMT bigint,
  ASSET_UNDETERM_VAL_IND character varying(1),
  ASSET_UNDETERM_VAL_AMT bigint,
  NON_CASH_CONTRIB_IND character varying(1),
  NON_CASH_CONTRIB_AMT bigint,
  AST_HELD_INVST_IND character varying(1),
  FIVE_PRCNT_TRANS_IND character varying(1),
  ALL_PLAN_AST_DISTRIB_IND character varying(1),
  FAIL_PROVIDE_BENEFIT_DUE_IND character varying(1),
  FAIL_PROVIDE_BENEFIT_DUE_AMT bigint,
  PLAN_BLACKOUT_PERIOD_IND character varying(1),
  COMPLY_BLACKOUT_NOTICE_IND character varying(1),
  RES_TERM_PLAN_ADPT_IND character varying(1),
  RES_TERM_PLAN_ADPT_AMT bigint,
  FDCRY_TRUST_EIN bigint,
  FDCRY_TRUST_NAME character varying(140),
  COVERED_PBGC_INSURANCE_IND character varying(1),
  TRUST_INCUR_UNREL_TAX_INC_IND character varying(1),
  TRUST_INCUR_UNREL_TAX_INC_AMT bigint,
  IN_SERVICE_DISTRIB_IND character varying(1),
  IN_SERVICE_DISTRIB_AMT bigint,
  FDCRY_TRUSTEE_CUST_NAME character varying(140),
  FDCRY_TRUST_CUST_PHON_NUM character varying(10),
  FDCRY_TRUST_CUST_PHON_NU_FORE character varying(30),
  DISTRIB_MADE_EMPLOYEE_62_IND character varying(1),
  PREMIUM_FILING_CONFIRM_NUMBER character varying(20)
);
