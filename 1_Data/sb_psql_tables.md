
## LOAD CSV INTO TABLE:

COPY sb_full FROM '/Users/moserfamily/Documents/DSI/DSI_Capstone_B/1_Data/form5500_data/F_SCH_SB_2017_latest.csv' DELIMITER ',' CSV HEADER QUOTE '"';
COPY sb_full FROM '/Users/moserfamily/Documents/DSI/DSI_Capstone_B/1_Data/form5500_data/F_SCH_SB_2016_latest.csv' DELIMITER ',' CSV HEADER QUOTE '"';
COPY sb_full FROM '/Users/moserfamily/Documents/DSI/DSI_Capstone_B/1_Data/form5500_data/F_SCH_SB_2015_latest.csv' DELIMITER ',' CSV HEADER QUOTE '"';

COPY sb_full FROM '/Users/moserfamily/Documents/DSI/DSI_Capstone_B/1_Data/form5500_data/F_SCH_SB_2014_latest.csv' DELIMITER ',' CSV HEADER QUOTE '"';
COPY sb_full FROM '/Users/moserfamily/Documents/DSI/DSI_Capstone_B/1_Data/form5500_data/F_SCH_SB_2013_latest.csv' DELIMITER ',' CSV HEADER QUOTE '"';
COPY sb_full FROM '/Users/moserfamily/Documents/DSI/DSI_Capstone_B/1_Data/form5500_data/F_SCH_SB_2012_latest.csv' DELIMITER ',' CSV HEADER QUOTE '"';

## Drop columns that are not in 2012 and 2013 SB:
ALTER TABLE sb_full
DROP COLUMN SB_RTD_VSTD_TGT_AMT,
DROP COLUMN SB_TERM_VSTD_FNDNG_TGT_AMT,
DROP COLUMN SB_TOT_VSTD_FNDNG_TGT_AMT,
DROP COLUMN SB_INT_PRIOR_YEAR_ACTUAL_AMT;

## CREATE TABLE - ALL FIELDS:

CREATE TABLE sb_full (
  ACK_ID character varying,
  SB_PLAN_YEAR_BEGIN_DATE date,
  SB_TAX_PRD character varying,
  SB_PN smallint,
  SB_EIN bigint,
  SB_PLAN_TYPE_CODE character varying,
  SB_CNT_PARTCP_PR_YR_CD character varying,
  SB_VALUE_DATE date,
  SB_CURR_VALUE_AST_01_AMT bigint,
  SB_ACTRL_VALUE_AST_AMT bigint,
  SB_RTD_PARTCP_CNT character varying(8),
  SB_RTD_FNDNG_TGT_AMT bigint,
  SB_TERM_PARTCP_CNT character varying(8),
  SB_TERM_FNDNG_TGT_AMT bigint,
  SB_ACT_NONVSTD_FNDNG_TGT_AMT bigint,
  SB_ACT_VSTD_FNDNG_TGT_AMT bigint,
  SB_ACT_PARTCP_CNT character varying(8),
  SB_LIAB_ACT_TOT_FNDNG_TGT_AMT bigint,
  SB_TOT_PARTCP_CNT character varying(8),
  SB_TOT_FNDNG_TGT_AMT bigint,
  SB_PLAN_AT_RISK_IND character varying(1),
  SB_TGT_DISREGARD_ASSUMP_AMT bigint,
  SB_TGT_REFLECT_ASSUMP_AMT bigint,
  SB_EFF_INT_RATE_PRCNT numeric,
  SB_TGT_NRML_COST_01_AMT bigint,
  SB_SIGNATURE_DATE character varying(10),
  SB_ACTUARY_NAME_LINE character varying(35),
  SB_ACTUARY_FIRM_NAME character varying(35),
  SB_ACTUARY_US_ADDRESS1 character varying(35),
  SB_ACTUARY_US_ADDRESS2 character varying(35),
  SB_ACTUARY_US_CITY character varying(22),
  SB_ACTUARY_US_STATE character varying(2),
  SB_ACTUARY_US_ZIP character varying(12),
  SB_ACTUARY_FOREIGN_ADDRESS1 character varying(35),
  SB_ACTUARY_FOREIGN_ADDRESS2 character varying(35),
  SB_ACTUARY_FOREIGN_CITY character varying(22),
  SB_ACTUARY_FOREIGN_PROV_STATE character varying(22),
  SB_ACTUARY_FOREIGN_CNTRY character varying(2),
  SB_ACTUARY_FOREIGN_POSTAL_CD character varying(22),
  SB_ACTUARY_PHONE_NUM character varying(10),
  SB_ACTRY_ENRLMT_NUM character varying(7),
  SB_ACTUARY_NOT_REFLECT_IND character varying(1),
  SB_CARRYOVER_PR_YR_AMT bigint,
  SB_PRE_FNDNG_PR_YR_AMT bigint,
  SB_CARRYOVER_USED_PR_YR_AMT bigint,
  SB_PRE_FNDNG_USED_PR_YR_AMT bigint,
  SB_CARRYOVER_PR_YR_TOT_AMT bigint,
  SB_PRE_FNDNG_PR_YR_TOT_AMT bigint,
  SB_INT_PR_YR_PRCNT numeric,
  SB_INT_PR_YR_CARRYOVER_AMT bigint,
  SB_INT_PR_YR_PRE_FNDNG_AMT bigint,
  SB_EXCESS_CONTRIB_AMT bigint,
  SB_EXCESS_CONTRIB_INT_PRCNT numeric,
  SB_EXCESS_CONTRIB_INT_AMT bigint,
  SB_EXCESS_CONTRIB_AVAIL_AMT bigint,
  SB_EXCESS_CONTRIB_ADDED_AMT bigint,
  SB_CARRYOVER_REDUCTION_AMT bigint,
  SB_PRE_FNDNG_REDUCTION_AMT bigint,
  SB_CARRYOVER_BOY_TOT_AMT bigint,
  SB_PRE_FNDNG_BOY_TOT_AMT bigint,
  SB_FNDNG_TGT_PRCNT numeric,
  SB_ADJ_FNDNG_TGT_PRCNT numeric,
  SB_PR_YR_FNDNG_PRCNT numeric,
  SB_AST_LESS_70_PRCNT numeric,
  SB_TOT_EMPLR_CONTRIB_AMT bigint,
  SB_TOT_EMPLEE_CONTRIB_AMT bigint,
  SB_CONTRIB_ALLOC_PR_YR_01_AMT bigint,
  SB_CONTRIB_AVOID_RESTRIC_AMT bigint,
  SB_CONTRIB_ALLOC_CURR_YR_AMT bigint,
  SB_FNDNG_SHORT_IND character varying(1),
  SB_QRTLY_INSTALL_IND character varying(1),
  SB_1ST_LIQUIDITY_SHORT_AMT bigint,
  SB_2ND_LIQUIDITY_SHORT_AMT bigint,
  SB_3RD_LIQUIDITY_SHORT_AMT bigint,
  SB_4TH_LIQUIDITY_SHORT_AMT bigint,
  SB_1ST_SEG_RATE_PRCNT numeric,
  SB_2ND_SEG_RATE_PRCNT numeric,
  SB_3RD_SEG_RATE_PRCNT numeric,
  SB_YIELD_CURVE_IND character varying(1),
  SB_APPLICABLE_MONTH_CD character varying(1),
  SB_WEIGHTED_RTM_AGE character varying(2),
  SB_MORTALITY_TBL_CD character varying(1),
  SB_CHG_ACTRL_ASSUMP_CURR_IND character varying(1),
  SB_CHG_METHOD_IND character varying(1),
  SB_SCH_ACTIVE_PARTCP_RQD_IND character varying(1),
  SB_ALT_FNDNG_RULES_CD character varying(1),
  SB_UNPAID_PR_YR_CONTRIB_AMT bigint,
  SB_CONTRIB_ALLOC_PR_YR_02_AMT bigint,
  SB_UNPAID_MIN_RQD_TOT_AMT bigint,
  SB_TGT_NRML_COST_02_AMT bigint,
  SB_SHORT_AMORTZ_OUTSTD_AMT bigint,
  SB_SHORT_AMORTZ_INST bigint,
  SB_WVRS_AMORTZ_OUTSTD_AMT bigint,
  SB_WVRS_AMORTZ_INST  bigint,
  SB_WVR_APPROVED_LTR_DATE character varying(10),
  SB_WAIVED_AMT bigint,
  SB_FNDNG_RQMT_TOT_AMT bigint,
  SB_OFFSET_CARRYOVER_AMT bigint,
  SB_OFFSET_PRE_FNDNG_AMT bigint,
  SB_OFFSET_BAL bigint,
  SB_ADDL_CASH_TOT_AMT bigint,
  SB_CONTR_ALLOC_CURR_YR_02_AMT bigint,
  SB_EXCES_CONTR_CURR_YR_TOT_AMT bigint,
  SB_UNP_MIN_CONT_CUR_YR_TOT_AMT bigint,
  SB_UNP_MIN_CONTRIB_ALL_YR_AMT bigint,
  SB_ACCELERATION_ADJ_AMT bigint,
  SB_ACTUARY_PHONE_NUM_FOREIGN character varying(30),
  SB_ELIGIBLE_PLAN_YEAR_1_IND character varying(1),
  SB_ELIGIBLE_PLAN_YEAR_2_IND character varying(1),
  SB_ELIGIBLE_PLAN_YEAR_3_IND character varying(1),
  SB_ELIGIBLE_PLAN_YEAR_4_IND character varying(1),
  SB_EXCESS_INSTALL_ACCELER_AMT bigint,
  SB_MIN_REQ_CONT_EXCESS_AST_AMT bigint,
  SB_PORT_PREFNDNG_FNDNG_CAR_AMT bigint,
  SB_PRESENT_VAL_EXCES_CONT_AMT bigint,
  SB_SHOR_AMOR_BASE_SCH_ELEC_IND character varying(1),
  SB_RTD_VSTD_TGT_AMT bigint,
  SB_TERM_VSTD_FNDNG_TGT_AMT bigint,
  SB_TOT_VSTD_FNDNG_TGT_AMT bigint,
  SB_INT_PRIOR_YEAR_ACTUAL_AMT bigint
);
